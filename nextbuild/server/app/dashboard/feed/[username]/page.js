(()=>{var e={};e.id=350,e.ids=[350],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},25993:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>u,routeModule:()=>x,tree:()=>d});var a=s(73137),n=s(54647),r=s(4183),i=s.n(r),o=s(71775),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=a.AppPageRouteModule,d=["",{children:["dashboard",{children:["feed",{children:["[username]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,70956)),"/Users/matteoraggi/Dev/avvoltoio-smm/src/app/dashboard/feed/[username]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5055)),"/Users/matteoraggi/Dev/avvoltoio-smm/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,84167)),"/Users/matteoraggi/Dev/avvoltoio-smm/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/matteoraggi/Dev/avvoltoio-smm/src/app/dashboard/feed/[username]/page.tsx"],h="/dashboard/feed/[username]/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new c({definition:{kind:n.x.APP_PAGE,page:"/dashboard/feed/[username]/page",pathname:"/dashboard/feed/[username]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74289:(e,t,s)=>{Promise.resolve().then(s.bind(s,91184))},91184:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>page});var a=s(60080),n=s(78735),r=s(91418),i=s(9885),o=s(94595),l=s(57546),c=s(50518),d=s(35550),u=s(75397),h=s(16526),m=s(73807),x=s(57114),p=s(11440),g=s.n(p),f=s(43872),j=s.n(f),b=s(92034),v=s.n(b),_=s(94599),C=s.n(_),w=s(52208),y=s.n(w),q=s(99360),L=s.n(q),N=s(56490);function IconVipPro(){return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"60",zoomAndPan:"magnify",viewBox:"0 0 30 30.000001",height:"80",preserveAspectRatio:"xMidYMid meet",version:"1.0",children:[a.jsx("defs",{children:a.jsx("clipPath",{id:"9b889669da",children:a.jsx("path",{d:"M 0.484375 0 L 29.515625 0 L 29.515625 29.03125 L 0.484375 29.03125 Z M 0.484375 0 ",clipRule:"nonzero"})})}),a.jsx("g",{clipPath:"url(#9b889669da)",children:a.jsx("path",{fill:"#4b2ca0",d:"M 17.0625 1.5 L 19.484375 0.710938 L 20.984375 2.773438 L 23.53125 2.773438 L 24.320312 5.195312 L 26.742188 5.984375 L 26.742188 8.53125 L 28.804688 10.03125 L 28.015625 12.453125 L 29.515625 14.515625 L 28.015625 16.578125 L 28.804688 19 L 26.742188 20.5 L 26.742188 23.046875 L 24.320312 23.835938 L 23.53125 26.261719 L 20.984375 26.261719 L 19.484375 28.320312 L 17.0625 27.535156 L 15 29.03125 L 12.9375 27.535156 L 10.515625 28.320312 L 9.015625 26.261719 L 6.46875 26.261719 L 5.679688 23.835938 L 3.257812 23.046875 L 3.257812 20.5 L 1.195312 19 L 1.980469 16.578125 L 0.484375 14.515625 L 1.980469 12.453125 L 1.195312 10.03125 L 3.257812 8.53125 L 3.257812 5.984375 L 5.679688 5.195312 L 6.46875 2.773438 L 9.015625 2.773438 L 10.515625 0.710938 L 12.9375 1.5 L 15 0 Z M 17.0625 1.5 ",fillOpacity:"1",fillRule:"evenodd"})}),a.jsx("path",{fill:"#ffffff",d:"M 8.03125 13.027344 C 7.449219 13.554688 7.40625 14.453125 7.929688 15.03125 C 9.003906 16.222656 10.742188 18.148438 11.773438 19.289062 C 12.242188 19.808594 13.042969 19.847656 13.5625 19.378906 C 15.5 17.628906 19.929688 13.628906 21.960938 11.792969 C 22.542969 11.269531 22.589844 10.371094 22.0625 9.789062 C 21.539062 9.207031 20.640625 9.164062 20.058594 9.6875 L 13.765625 15.371094 C 13.246094 15.839844 12.445312 15.800781 11.976562 15.28125 C 11.398438 14.640625 10.632812 13.792969 10.035156 13.132812 C 9.511719 12.550781 8.613281 12.503906 8.03125 13.027344 Z M 8.03125 13.027344 ",fillOpacity:"1",fillRule:"evenodd"})]})}var A=s(63900),S=s(16614),k=s.n(S),R=s(62969),P=s.n(R),B=s(95915),M=s.n(B),E=s(16856),z=s.n(E),Z=s(42153),F=s.n(Z),T=s(69841);let components_ChannelSubbed=e=>{let t=e.channelSubbed,s=e.user,[r,l]=i.useState(!1),[c,d]=i.useState("paper"),[u,h]=i.useState([]),{clients:m,setClients:x}=i.useContext(o.ClientsContext),handleClose=()=>{l(!1)},getRemainingChars=()=>{let e=n.F+`api/channels/sub/get/smm/${m.login}/${s}`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{console.log(e),h(e)}).catch(e=>{console.log("Authorization failed: "+e.message)})};return(0,a.jsxs)(i.Fragment,{children:[(0,a.jsxs)("p",{className:"py-2 px-5 bg-[#4B2CA0] text-white rounded-2xl text-[22px] pointer",onClick:()=>{l(!0),d("paper"),getRemainingChars()},children:[t," canali seguiti"]}),(0,a.jsxs)(P(),{open:r,onClose:handleClose,scroll:c,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",fullWidth:!0,transitionDuration:300,children:[(0,a.jsxs)("div",{className:"flex items-center justify-center border border-dashed",children:[a.jsx("div",{className:"flex-1"}),a.jsx(F(),{id:"scroll-dialog-title",className:"text-center flex-1 text-2xl",children:"Canali Seguiti"}),a.jsx(M(),{className:"flex-1",children:a.jsx(k(),{onClick:handleClose,children:a.jsx(T.Z,{})})})]}),a.jsx(z(),{dividers:"paper"===c,children:u.map(e=>a.jsx(g(),{href:`/dashboard/feed/channel/${e.channel._id}`,children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-5 p-2 border-2 border-[#4B2CA0] rounded-xl",children:[a.jsx("div",{children:a.jsx("p",{className:"text-xl",children:e.channel.name})}),a.jsx("div",{children:a.jsx("p",{className:"PRIVATEGROUP"==e.channel.type?"bg-red-600 text-white rounded-xl text-[18px] px-3 py-1":" bg-green-700 text-white rounded-xl text-[18px] px-3 py-1",children:e.channel.type})})]})}))})]})]})};var $=s(52451),I=s.n($),U=s(91226);let page=({params:e})=>{let t=(0,x.useRouter)(),s=/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/gm,p=e.username,{clients:f,setClients:b}=(0,i.useContext)(o.ClientsContext),[_,w]=(0,i.useState)([]),[q,S]=(0,i.useState)(!1),[k,R]=(0,i.useState)(),[P,B]=(0,i.useState)(),[M,E]=(0,i.useState)(),[z,Z]=(0,i.useState)(),F=(0,i.useRef)(""),T=(0,i.useRef)(!0),$=(0,i.useRef)(!0),G=(0,i.useRef)(0),D=[{name:"heart",label:"heart",icon:a.jsx(l.Z,{}),command:()=>{addReaction("heart",!0)}},{name:"exploding",label:"exploding",icon:a.jsx(c.Z,{}),command:()=>{addReaction("exploding",!0)}},{name:"cold",label:"cold",icon:a.jsx(d.Z,{}),command:()=>{addReaction("cold",!0)}},{name:"nerd",label:"nerd",icon:a.jsx(u.Z,{}),command:()=>{addReaction("nerd",!1)}},{name:"clown",label:"clown",icon:a.jsx(h.Z,{}),command:()=>{addReaction("clown",!1)}},{name:"bored",label:"bored",icon:a.jsx(m.Z,{}),command:()=>{addReaction("bored",!1)}}],getUserByLogin=()=>{let e=n.F+`api/user-by-name/?name=${p}`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{R(e)}).catch(e=>{console.log(e)})},getUserChars=()=>{let e=n.F+"api/chars-by-login/"+p;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{B(e.remainingChars)}).catch(e=>{console.log("Authorization failed: "+e.message)})},O=n.F+`api/squeal-by-user/smm/${p}/?page=${G.current}&size=10`,V=n.F+`api/squeal-by-user/smm/${p}/?page=0&size=10`,loadContent=e=>{S(!0),fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{T.current&&(T.current=!1),w(t=>[...t,...e]),G.current++,console.log(_)}).catch(e=>{console.log(e)}).finally(()=>{S(!1)})},squealMadeByUserCount=()=>{let e=n.F+`api/squeal-made-by-user-count/${p}`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{E(e)}).catch(e=>{console.log("Authorization failed : "+e.message)})},getChannelSubbed=()=>{let e=n.F+`api/channels/sub/count/${p}`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")}}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{console.log(e),Z(e)}).catch(e=>{console.log("Authorization failed : "+e.message)})},addReaction=(e,t)=>{let s=n.F+`api/client-squeal-reaction/create/${f.login}`;fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("id_token")},body:JSON.stringify({positive:t,emoji:e,squeal_id:F.current})}).then(e=>{if(!e.ok)throw e.status;return e.json()}).then(e=>{var t;_.map(e=>{e?.squeal?._id===F.current&&(t=e)});let s=t?.reactions?.find(e=>e.reaction===t?.active_reaction);if(t?.active_reaction){if(s?.number&&(s.number--,s.number<=0)){let e=t?.reactions.indexOf(s);t?.reactions?.splice(e,1)}if("deleted"===e.emoji){t.active_reaction=null;let s=_.map(t=>(t?.squeal?._id===e.squeal_id&&(t.squeal._id=t.squeal._id+""),t));w(s);return}}if(s=t?.reactions?.find(t=>t.reaction===e.emoji),s?.number)s.number++;else{let s={number:1,reaction:e.emoji??"deleted",user:!1};t?.reactions?.push(s)}t.active_reaction=e.emoji;let a=_.map(t=>(t?.squeal?._id===e.squeal_id&&(t.squeal._id=t.squeal._id+""),t));w(a)}).catch(e=>{console.log(e)})};(0,i.useEffect)(()=>(window.addEventListener("scroll",loadMore),()=>window.removeEventListener("scroll",loadMore)),[q]),(0,i.useEffect)(()=>{getUserByLogin(),$.current&&(w([]),G.current=0,loadContent(V),$.current=!1,getUserChars(),squealMadeByUserCount(),getChannelSubbed())},[]);let loadMore=()=>{if(T.current)return;let e=document.documentElement.scrollTop,t=document.documentElement.scrollHeight,s=document.documentElement.clientHeight;e+s>=t&&!q&&loadContent(O)};var H="";return H=k?.img_content_type?`data: ${k.img_content_type}  ;base64, ${k.img}`:"",a.jsx(a.Fragment,{children:(0,a.jsxs)("section",{children:[a.jsx("div",{className:"arrow-back pointer",children:a.jsx(r.Z,{sx:{fontSize:50},onClick:()=>t.back()})}),f.email?(0,a.jsxs)("div",{className:"feed",children:[(0,a.jsxs)("div",{className:"flex w-1/2",children:[k?.img_content_type?a.jsx(I(),{className:"w-36 h-36 rounded-full mr-3",src:H,alt:"Rounded avatar",width:150,height:150}):a.jsx(I(),{className:"w-36 h-36 rounded-full mr-3",src:U.Z,alt:"Rounded avatar",width:150,height:150}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("h1",{className:"text-black mr-3",children:["@",p]}),k?.authorities.includes("ROLE_SMM")||k?.authorities.includes("ROLE_VIP")&&a.jsx(IconVipPro,{})]}),(0,a.jsxs)("p",{className:"text-[#B4ACAC]",children:[k?.first_name," ",k?.last_name]}),(0,a.jsxs)("p",{className:"text-[#B4ACAC] ml-3",children:[P," caratteri rimasti"]})]})]}),(0,a.jsxs)("div",{className:"flex w-1/2 gap-12 mt-6 justify-start",children:[a.jsx(components_ChannelSubbed,{channelSubbed:z,user:p}),(0,a.jsxs)("p",{className:"py-2 px-5 bg-[#4B2CA0] text-white rounded-2xl text-[22px]",children:[M," squeal fatti"]})]}),a.jsx("span",{className:"mt-6"}),_.map(e=>{let t=Date.now(),getIcon=e=>{switch(e){case"heart":return a.jsx(l.Z,{});case"exploding":return a.jsx(c.Z,{});case"cold":return a.jsx(d.Z,{});case"nerd":return a.jsx(u.Z,{});case"clown":return a.jsx(h.Z,{});case"bored":return a.jsx(m.Z,{});default:return null}},n=`data: ${e.squeal?.img_content_type}  ;base64, ${e.squeal?.img}`,r=e.squeal?.body?.split(" ");return(0,a.jsxs)("div",{className:"p-5 w-1/2 bg-white shadow-lg shadow-grey-500/50 rounded-xl mt-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center border-slate-500 ",children:[(0,a.jsxs)("div",{className:"flex flex-row",children:[e.userImg&&e.userImg[0].length>1?a.jsx(I(),{className:"w-10 h-10 rounded-full mr-3",src:e.userImg[0],alt:"Rounded avatar",width:50,height:50}):a.jsx(I(),{className:"w-10 h-10 rounded-full mr-3",src:U.Z,alt:"Rounded avatar",width:50,height:50}),a.jsx(g(),{href:"/dashboard/feed/"+e.userName,className:"flex content-center justify-center align-middle",children:(0,a.jsxs)("h3",{className:"font-normal text-2xl",children:["@",e.userName]})})]}),a.jsx("span",{className:"text-[16px] font-medium inline-flex text-[#B4ACAC]",children:function(e,t){var s=e-t;return s<6e4?Math.round(s/1e3)+" seconds ago":s<36e5?Math.round(s/6e4)+" minutes ago":s<864e5?Math.round(s/36e5)+" hours ago":s<2592e6?Math.round(s/864e5)+" days ago":s<31536e6?"about "+Math.round(s/2592e6)+" months ago":"about "+Math.round(s/31536e6)+" years ago"}(t,e?.squeal?.timestamp)})]}),a.jsx("div",{className:"flex gap-1 mt-4",children:e?.squeal?.destination?.map((e,t)=>a.jsx("p",{className:"mr-4 bg-[#4B2CA0] py-1 px-4 rounded-3xl text-white text-[16px]",children:a.jsx(g(),{href:"/dashboard/feed/channel/"+e.destination_id,children:e.destination})},t))}),(0,a.jsxs)("div",{className:"mt-6",children:[e.squeal?.img&&e.squeal?.img?.length!=0?a.jsx(I(),{src:n,alt:"image",width:500,height:500}):null,e.geoLoc?.latitude&&e.geoLoc.longitude?a.jsx(i.Suspense,{children:a.jsx(A.default,{lat:e.geoLoc.latitude,lng:e.geoLoc.longitude})}):null,a.jsx("p",{className:"mt-3",children:r?.map(e=>e.match(s)?a.jsxs(a.Fragment,{children:[a.jsx("a",{href:e,target:"_blank",className:"underline text-[#0000EE]",children:e},e)," "]}):e+" ")})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-6 items-end mb-6",children:[a.jsx(N.Z,{squeal_id:e?.squeal?._id,squealDestinations:e?.squeal?.destination,user_id:e?.squeal?.user_id,num_comments:e?.comments_number}),(0,a.jsxs)("div",{className:"flex",children:[e.squeal.body.length>1?(0,a.jsxs)("p",{className:"text-[16px] font-medium inline-flex text-[#B4ACAC]",children:[e.squeal?.body?.length," Caratteri"]}):(0,a.jsxs)("p",{className:"text-[16px] font-medium inline-flex text-[#B4ACAC]",children:[e.squeal?.body?.length," Carattere"]}),(0,a.jsxs)("p",{className:"text-[16px] font-medium inline-flex ml-5 text-[#B4ACAC]",children:[e?.views?.number," Views"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-6 items-end mb-6",children:[a.jsx("div",{className:"reactions",children:a.jsx(j(),{children:a.jsx(v(),{ariaLabel:"Reaction SpeedDial",icon:a.jsx(C(),{}),direction:"right",FabProps:{sx:{bgcolor:"#F4F4F4",color:"#4B2CA0","&:hover":{bgcolor:"#4B2CA0",color:"#F4F4F4"}}},children:D.map((t,s)=>a.jsx(y(),{icon:t.icon,tooltipTitle:t.name,onClick:function(){void 0!=e.squeal&&void 0!=e.squeal._id&&null!=F.current&&(F.current=e.squeal._id,t.command())},className:"w-12 h-12"},s))})})}),a.jsx("ul",{className:"flex gap-x-3",children:e?.reactions?.map((e,t)=>a.jsxs("li",{className:"relative flex items-center gap-x-3 bg-white rounded-3xl",children:[getIcon(e.reaction),a.jsx("div",{className:"absolute inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-[#4B2CA0] border-2 border-white rounded-full -bottom-2 -end-2 dark:border-gray-900",children:e.number})]},t))})]})]},e?.squeal?._id)}),q?a.jsx(j(),{sx:{display:"flex"},children:a.jsx(L(),{})}):null]}):a.jsx("p",{className:"flex justify-center",children:"Scegli un utente"})]})})}},70956:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>l});var a=s(17536);let n=(0,a.createProxy)(String.raw`/Users/matteoraggi/Dev/avvoltoio-smm/src/app/dashboard/feed/[username]/page.tsx`),{__esModule:r,$$typeof:i}=n,o=n.default,l=o},57114:(e,t,s)=>{e.exports=s(82778)}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[672,520,194,418,937,195,359,264,360,978,85,464,333,900],()=>__webpack_exec__(25993));module.exports=s})();